<div id="building" class="textpage">
<div class="leftcol">
<p>As a complex mapping application, ORBIS utilizes a number of different geospatial technologies to model movement in the Roman World.</p>
<h3 id="top2">Building ORBIS: Multi-modal network model</h3>
<p>The model that drives ORBIS consists of several datasets and the interrelation between those datasets as defined algorithmically by various functions. The data was developed through several mechanisms, the most familiar being the creation of GIS features through transcription and derivation. The data that underlies the model is explained below, and all of the functions which process this data in PostGIS will be released with annotation at a later point.</p>
<h4>Sites</h4>

<div class="inlinepic"><a href="#" onclick="picWin('figbit1.png', 'cap_b01')"><img src="figures/figbit1t.png"/></a><p><span class="caption" id="cap_b01">Figure 1. Displayed sites in ORBIS, sized by rank</span></p></div>

<p>Many of the nodes in the ORBIS network are not displayed due to their being considered outside the scope of the model or redundant, or because they are considered a hidden "crossroads" node that is only taken into account during pathfinding. (see figures below) Sites have been ranked by Scheidel into five categories that determine the size of the icons representing them as well as whether or not their label is displayed on the map at particular resolutions.</p>
<p>Site labels, when ambiguous or disputed, were decided by Scheidel. Nearly all of the coordinates (latitude and longitude) for the sites in ORBIS come from the <a href="http://pleiades.stoa.org">Pleiades Project</a>, which serves as a repository for spatial data of the ancient world.</p>

<div class="inlinepic"><a href="#" onclick="picWin('figbit2.png', 'cap_b02')"><img src="figures/figbit2t.png"/></a><p><span class="caption"  id="cap_b02">Figure 2. Undisplayed sites (blue) in ORBIS</span></p></div>
<div class="inlinepic"><a href="#" onclick="picWin('figbit3.png', 'cap_b03')"><img src="figures/figbit3t.png"/></a><p><span class="caption"  id="cap_b03">Figure 3. Crossroads sites (blue triangles) are treated as nodes by the underlying pathfinding algorithm.</span></p></div>

<h4>The Routing Table</h4>

<p>Routes in ORBIS are determined by finding the Dijkstra distance through a table of segments derived from three models representing the road, river and sea routes, as well as five special ferry routes. Segments are represented as edges between two nodes, referred to in ORBIS as sites, which are stored in a separate table with additional data such as the site's name and administrative ranking. Dijkstra's pathfinding algorithm determines the shortest path through a network based on arbitrary costs for movement from one node to another. In the case of the ORBIS network, this cost is either the expense of shipping grain or passengers; the duration of travel along the route by a particular transportation method; or the raw distance of the routes themselves. In the web interface as well as later explanations, these three methods are referred to as, respectively, the cheapest, fastest or shortest routes. While the obvious differences in priority between the cheapest and fastest routes will be most interesting to scholars, we included the shortest route possibility as well so as to highlight the fact that the shortest distance between two points is rarely the least cost distance between them, regardless of whether that cost is in time or money.</p>
<p>In addition to traditional transportation segments, each node in the network is connected to metanodes representing transfer points to sea and river segments. It is through assigning a cost to the switch to these metanodes that transfer costs are implemented.</p>
<p>The ORBIS model takes into account a time variable (at monthly resolution) in the determination of a least cost path through the system, but it does not take into account the time taken by the actual path. As such, any route that takes longer than 30 days is not aware of a change in the state of the model during travel time. This was explored during the early stages of building the model but set aside due to complexity. Higher resolution temporal data, as well as dynamic routes temporally through the system, would be an improvement for a future model.</p>

<p>More advanced pathfinding with heuristics was tested (primarily the A* algorithm implemented in pgRouting) but given the relatively small dataset (only 12,000 or so individual segments in the network), there was no improvement in speed as far as typical pathfinding queries, for which computing costs are primarily those necessary to divide and sort the network based on its multimodal and temporal characteristics.</p>

<p>The routing table itself has a simple format:</p>
<img src="figures/tabbit1.png"/>

<p>This is the entry for the coastal route from Euesperides (ORBIS ID 50538) to Zacynthus (ORBIS ID 50540). The cost value indicates the amount of time, in days, it would take to travel this route during December as derived from the sea model below. In the case of river and road routes, the amount of time is derived from the length of the polyline representing the route and the speed of the transportation method selected or the speed of the river, respectively.</p>

<h4>The Ferry Routes</h4>

<p>Ferry routes exist across the Strait of Gibraltar (Tingi to Gades), the Bosporus (Constantinopolis to Chalcedon), the Strait of Messina (Regium to Messana), the Dardanelles (Kallipolis to Lampsacus) and the Strait of Dover (Rutupiae to Gesoriacum). These ferry routes cannot be disabled in the web interface and are designed to serve two purposes. First, they allow a user to explore purely land travel without restricting such travel to contiguous areas. Second, they ensure year-round access to Britain, which was historically true but--for a single month--runs afoul of the wave-height restrictions used in the sea model (explained in detail below). The ferry routes are hard-coded to take 1 day in either direction, except in the Dardanelles and the Strait of Gibralter, which take the modeled amount of time.</p>

<h4>The Road Model</h4>

<div class="inlinepic"><a href="#" onclick="picWin('figbit4.png', 'cap_b04')"><img src="figures/figbit4t.png"/></a><p><span class="caption"  id="cap_b04">Figure 4. Road Routes in ORBIS</span></p></div>

<p>Roads within this system are represented as polyline segments connecting two sites. Generally, the directionality of these lines is not taken into account, as the entire table of road segments is duplicated and mirrored to build the routing table mentioned above. There is one exception to directionality, and that is in relation to cost modifiers that simulate the effects of traveling on steep grade. This condition is obviously amenable to a sophisticated solution. Given that the entire ORBIS database exists in a PostGIS2 database and is therefore natively capable of 3D spatial data, there were some early experiments with deriving z-values of the road network from 30m ASTER digital elevation models (DEMs).</p>
<p>During the course of this project we were made aware of higher resolution route data in Spain (Gonz√°lez 2011) and Turkey, which might prove suitable for integration into the ORBIS network but would require mechanisms to account for the uneven resolution in contrast with the rest of the network.</p>
<p>Some steps have been taken to include high resolution roads in Roman Britain, that are enabled and disabled using the same mechanism used for other modes.</p>
<div class="inlinepic"><img src="figures/figbit5t.png"/><p><span class="caption">Figure 5. Representative elevation changes in roads as cross-sections</span></p></div>

<p>By sampling the polyline segments using available raster elevation data, we could provide more than just the net change in altitude from the start of the route to the end of the route (a value that would fail to account for the difference between any of the above routes) as well as provide more meaningful route cost data than the maximum altitude of the route (which would work well for routes like A in Figure 5, but only poorly account for the cost of those like B and miss entirely the cost of a route like C).</p>

<div class="inlinepic"><a href="#" onclick="picWin('figbit6.png', 'cap_b06')"><img src="figures/figbit6t.png"/></a><p><span class="caption"  id="cap_b06">Figure 6. ORBIS Land Routes with Z-level Data</span></p></div>

<p>In Figure 6 is displayed a draft scene of the early ORBIS network with the altitude of the road routes derived from DEM data. Road segments are colored by maximum elevation though a proper implementation would focus on total slope or some type of vector ruggedness measure.</p>
<p>With 3D roads, ORBIS would be able to determine cost modifiers based on direction on-the-fly and take into account not only overall change in elevation but aggregate change in elevation over the course of the entire segment. Unfortunately, the low resolution and uncertainty of certain road segments resulted in erroneous z-values. This is one of the most achievable improvements to the ORBIS model but would require significant investment to improve the resolution of the described road segments followed by a study of the historical record to correlate cost modifiers based on change in altitude.</p>

<div class="inlinepic"><a href="#" onclick="picWin('figbit7.png', 'cap_b07')"><img src="figures/figbit7t.png"/></a><p><span class="caption"  id="cap_b07">Figure 7. Elevation data around Rome from 30m SRTM data</span></p></div>

<p>Note especially the path of the road from Tibur to Alba Fucens in Figure 7, which if sampled directly would indicate several major grades rather than more intuitive paths that avoid major shifts in elevation. While it would be seductive to simply "fix" these routes based on putative least cost paths using slope or vector ruggedness derived from DEMs, a set of historically accurate paths would require a focused scholarly effort.</p>
<p>As a result of issues involving integration of 3D data, the road model currently handles altitude-based modifiers and restrictions purely categorically. Certain routes have additional cost applied to travel upon them (either in one direction or both directions) and some of these routes are further restricted in the transportation methods that can utilize them during set months of the year.</p>
<p>The road model factors in altitude constraints using two methods. The first is to increase the amount of time necessary to travel along certain routes. This can be in either direction (represented on the figure as routes with circles) or in one direction (represented with triangles). The second method is to make certain routes unavailable to certain transportation methods during particular months. In the figures below, these routes are highlighted in green.</p>

<div class="inlinepic"><a href="#" onclick="picWin('figbit8.png', 'cap_b08')"><img src="figures/figbit8t.png"/></a><p><span class="caption"  id="cap_b08">Figure 8. Restricted Route Segments. Category 1 route segments in light orange, category 2 in medium orange and category 3 segments in red. Monthly restricted routes are further highlighted in green.</span></p></div>

<p>The three levels of movement modifier categorization (including directionality) as well as the restrictions in transportation method are stored in fields in the roads table and affect the transformation of the road data into directed edges in the network when pulled into the routing table. </p>
<div class="inlinepic"><a href="#" onclick="picWin('figbit9.png', 'cap_b09')"><img src="figures/figbit9t.png"/></a><p><span class="caption"  id="cap_b09">Figure 9. Detail of Restricted Land Routes</span></p></div>

<p>Note that the route from Segusio to Augusta Taurinorum shows the arrows pointed toward A. Taurinorum when the route restriction actually applies to travel from A. Taurinorum to Segusio. This is because when the route was originally drawn, the polyline itself (a spatial data object) was drawn left to right and so technically points in that direction. The ORBIS model, however, does not take this direction into account, but only looks at the accompanying source and target entries for the polyline, which are properly labeled in the other direction.</p>

<p>For instance, the road from Vappincum to Segusio is considered a Category 2b road with restrictions. Category 2 roads are treated as being 36km longer than the actual length of the road, and the 'b' designation indicates that this is bidirectional, so this modifier is accounted for in trips from Vappincum to Segusio as well as trips from Segusio to Vappincum. If this was a Category 2d (or directed) road, then the modifier would only apply for trips from Vappincum to Segusio. Further, this road is restricted in transportation modes such that oxcarts and carriages cannot use it from January to March.</p>

<h4>The River Model</h4>

<div class="inlinepic"><a href="#" onclick="picWin('figbit10.png', 'cap_b10')"><img src="figures/figbit10t.png"/></a><p><span class="caption"  id="cap_b10">Figure 10. River Routes in ORBIS</span></p></div>

<p>Rivers, in contrast to roads, are always directed edges. The data model stores rivers with their direction of flow downstream, as well as the variable upstream and downstream speed as determined per river (and in the case of the Nile, per month) by Scheidel. When processed into the routing table, the rivers table is first brought in as downstream edges and then brought in a second time, flipped, as upstream edges. River courses are based on modern tracks.</p>

<h4>The Sea Model</h4>
<div class="inlinepic"><a href="#" onclick="picWin('figbit11.png', 'cap_b11')"><img src="figures/figbit11t.png"/></a><p><span class="caption"  id="cap_b11">Figure 11. Coastal routes in green and overseas routes in blue.</span></p></div>

<p>The sea model is based on a mesh of polylines (referred to as the sea mesh) that connect ~40,000 points (referred to as nodes in the sea mesh), each separated by .1 degree, that overlap on the water areas corresponding with the Mediterranean, Black Sea and the small part of the Atlantic within the study area. There are 8 connections between each node, and these connections are referred to as edges and have the cardinal or ordinal direction of the edge coded in the table that stores them. So, we have a node at every .1 degree interval with eight edges to its neighboring nodes (if there is an immediate neighbor node) labeled "N", "NE", "E", "SE", "S", "SW", "W", "NW".</p>

<div class="inlinepic"><a href="#" onclick="picWin('figbit12.png', 'cap_b12')"><img src="figures/figbit12t.png"/></a><p><span class="caption"  id="cap_b12">Figure 12. The mesh off the coast of the Levant, including port routes connecting possible ports with the mesh</span></p></div>
<p>The data for wind force and frequency is drawn from two sources: a pilot chart that gives wind roses at 5 degree intervals for the Atlantic and Mediterranean regions and a table of similar but more detailed data at 1 degree intervals for the Black Sea. This data provides wind frequency by cardinal or ordinal direction as a percentage over the course of a month, as well as wind force using the Beaufort scale from that direction during the month. Currently, due to the manner in which the Black Sea data is stored, wind force for all Black Sea data is treated as Beaufort 3.</p>

<div class="inlinepic"><img src="figures/figbit13t.png"/><p><span class="caption"  id="cap_b13">Figure 13. A typical wind rose</span></p></div>

<p>There are several formats for storing wind data in environmental science datasets, whether on-line or traditional. The most suitable and approachable for our model is in the form of wind roses, like those above. The wind rose describes average force and frequency during a period (such as a month) by direction denoting the former with ticks on and the latter with length of the line corresponding to the ordinal or cardinal direction of the wind.</p>

<p>The model derives a cost, in time, to travel along one edge in the direction of the edge based off the length of the edge times the speed in knots of a ship assumed to be subject to the average frequency and force of winds for that region. We have used several ship models, which react differently in their effectiveness of dealing with headwinds and also have different top speeds. This gives each edge a different cost value in time depending on the direction of travel from node to node.</p>

<p>With these values assigned to the sea mesh, we run directed Dijkstra least cost paths through the network to find hypothetical sea route paths as well as cost in time for an entire route. Regions defined by pilot charts as having greater than 10% occurrence of 3m+ waves during the month of the route are considered impassable and are removed from the sea mesh before any paths are run.</p>

<p>So far, our two ship models based on the performance of Dutch Cogs (deemed Slower and Faster due to slight variations in the way the model handles wind strength resulting in slightly slower and faster ships) have had the closest results to historically attested routes for the region and the months in question.</p>

<p>Initial test runs of the sea model used the ArcGIS package's ArcPy scripting tool to provide raster interpolation of the wind data over the study area. Inverse Distance Weighting, Kriging and splines were explored to determine the most appropriate method to interpolate wind frequency and strength. This raster data was then sampled by the mesh using zonal statistics. These methods were set aside to use Theissen interpolation (also known as "nearest neighbor") to foreground the necessity for more work in this area and avoid increasing the appearance of sophistication of the model without adequately being able to assure it was increasing its accuracy. Additionally, a search for higher resolution wind data in wind rose format yielded poor results. Given these factors and the low number of sensor points available for the wind data, it was decided that any method of interpolation of values beyond assigning the wind value for each mesh point from the nearest sensor point should be explored in later iterations of this model.</p>
<div class="inlinepic"><a href="#" onclick="picWin('figbit14.png', 'cap_b14')"><img src="figures/figbit14t.png"/></a><p><span class="caption" id="cap_b14">Figure 14. Derived routes (in green) through the mesh.</span></p></div>

<p>Dijsktra distance through this mesh results in different paths to and from each site. While we wanted to run all routes for all months for all sea ports and then trim these routes based on certain parameters, this proved to be unfeasible given the amount of processing time necessary to run ~1 million shortest path queries on the 160,000 entry mesh table. Instead, the coastal and sea routes that have been run were drawn from a list created by Scheidel.</p>

<p>Sea routes are grouped into two categories, coastal and overseas based on designation by Scheidel. These definitions are based solely on whether a route connects nearby sites that share the same coastline, and do not operate with any relation to the coastlines (for instance, through a buffer or a viewshed). As such, some coastal routes will follow least cost paths beyond the visible range of coastlines and some overseas routes may hug coastlines for much of their path. The ability to turn coastal and overseas travel off and on is available to ORBIS users in order to facilitate simulation of different types of participants.</p>

<div class="inlinepic"><a href="#" onclick="picWin('figbit15.png', 'cap_b15')"><img src="figures/figbit15t.png"/></a><p><span class="caption" id="cap_b15">Figure 15. Restricted sea zones based on wave height</span></p></div>

<p>Along with wind speed and direction, the pilot charts we examined showed regions of 3m+ waves with more than 10% frequency during the month reported. We designated these regions to be impassable during those months, affecting the sea routes by forcing the model to go around these restricted zones. Wave height-based restrictions affect the Atlantic primarily, but also create a shifting barrier between Sardenia/Corsica and the coast of France from November to March. As with other elements of this model, a more accurate reflection of the constraints posed by high seas or other navigational restrictions will have to wait until sufficient data and applicable models have been developed.</p>

<h3 id="roads">Roads<a href="#top2"><img src="images/contents.png" width="100" height="12" border="0" /></a></h3>
<p>The ORBIS road network is made up of 751 vector line segments digitized from a number of georeferenced maps using the common GIS applications ESRI ArcGIS and Quantum GIS. In a technical sense, especially compared with how the sea route network was derived, the digitizing of roads is relatively straightforward. The basic data set to which the roads would be introduced was a vector polygon outline of the countries surrounding the Mediterranean and a vector point file representing the ancient sites included in the ORBIS network. Our goal was to create land-based routes between all these points. The roads were selected according to research criteria outlined elsewhere on this website, and drafted according to their depiction in georeferenced raster map images (either TIFFS or JPGS). The principal source of information on roads was The Barrington <span class="italic">Atlas of the Greek and Roman World</span>  (Talbert 2000), already made available in a georeferenced format by the Cambridge University Press in association with Talbert 2011. Greece, Egypt, and northern Mesopotamia were the only areas of our network where Talbert 2000 did not include details of the Roman road system. For these regions, suitable alternative maps were scanned and introduced as TIFF files to ArcGIS (Fakhry 1974; Koder and et al. 1976; Soustal 1981; Stier 1991). These scanned maps were then georeferenced based on the ancient cities point file and national outlines polygon.</p>

<p>All roads in the ORBIS network were in a single line vector file created in an equidistant projection. Each of these roads begins and ends either at a point representing a site, or connect directly with the other road lines, so that the network roads either reach a destination or merge with another road. For this process, the ESRI ArcMAP snapping function was utilized so that the road segments began and ended precisely at the site points or at alternate roads. Each line was assigned a name and code number which acted as a primary key for the large attribute table associated with the vector lines. For example a road between city "A" and city "B" would be named "A to B" and given a number assigned sequentially such as "1010". This coding was useful as a handle for those building the network, as each route has a significant amount of information associated with it. The attribute table keyed by the name and code number contained information such as the list of possible means of transport for each road and the time cost of each travel mode for each of the road segments. Also included in the attribute table was information from more traditional research such as references, dates, and primary sources. The length of each route was automatically generated and included in this table by the geodatabase format typical of these GIS platforms.</p>
<p>These roads are supplemented by "high resolution" routes currently only deployed for Roman Britain. </p>
<p>Because the sea routes and river routes of the ORBIS network are also line vector data connected using the city point file, the road network easily integrates with the other forms of travel to create the greater ORBIS network.</p>

<h3 id="terrain">Terrain Layer<a href="#top2"><img src="images/contents.png" width="100" height="12" border="0" /></a></h3>
<p>Accurate historical terrain used in the base layer of the ORBIS map comes from the <a href="http://awmc.unc.edu/">Ancient World Mapping Center</a> and was integrated into ORBIS with the support of Ryan Horne.</p>

<h3 id="web">Web site<a href="#top2"><img src="images/contents.png" width="100" height="12" border="0" /></a></h3>
<p>The ORBIS website utilizes <a href="http://d3js.org/">D3.js</a> extensively for mapping and information visualization. This includes the use of topology-aware voronoi polygons for zones as well as convex hulls for regions, as well as D3's robust mapping framework to deploy highly detailed geodata using TopoJSON.</p>
<p>There is some significant processing done in the browser, such as simplifying the base layer of paths to make them amenable to distortion in the dynamic distance cartogram, as well as drawing the various static PNG maps on the fly using the HTML5 Canvas API.</p>

</div> <!-- end leftcol -->
</div> <!-- end building -->